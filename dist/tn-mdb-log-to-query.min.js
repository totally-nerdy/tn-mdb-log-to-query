function tnMongoDBLogToQuery(e){function r(e){var r,o;if(e.match(/(?<="\$regularExpression":)(.*?)(?<=})/gm))for(r of e.match(/(?<="\$regularExpression":)(.*?)(?<=})/gm))try{var t=JSON.parse(r);console.debug("$regularExpression",r,t),e=e.replace(`{"$regularExpression":${r}}`,`/${t.pattern}/`+t.options)}catch(e){console.error("Couldn't parse $regularExpression",r)}if(e.match(/(?<="\$date":)(.*?)(?=})/gm))for(o of e.match(/(?<="\$date":)(.*?)(?=})/gm))try{var a=JSON.parse(o);console.debug("$date",o,a),e=e.replace(`{"$date":${o}}`,`ISODate(${o})`)}catch(e){console.error("Couldn't parse $date",o)}return e}console.debug("Input:",e);let o="";try{var t=JSON.parse(e);if(console.debug("JSON:",t),t.attr&&t.attr.command){var a,n,s,g,i,l=t.attr.command;let e;l.aggregate?(a=l.pipeline,n=JSON.stringify(a),e=l.aggregate,n=r(n),o=`db.${e}.aggregate(${n});`):l.find&&(s=l.filter,g=l.sort,i=JSON.stringify(s),e=l.find,i=r(i),o=`db.${e}.find(${i})`,g&&(o+=`.sort(${JSON.stringify(g)})`),o+=";")}}catch(e){console.error(e),alert("The given input doesn't look like a JSON string. Are you on a MongoDB version < 4.4? Please paste only one log message at a time.")}return o}